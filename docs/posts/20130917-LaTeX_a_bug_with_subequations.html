<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2018-11-17 Sat 06:28 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>LaTeX: a bug with subequations</title>
<meta name="generator" content="Org mode">
<link rel="stylesheet" href="../theme.css"/>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
</head>
<body>
<div id="preamble" class="status">
<img id="banner" src="../images/banner.jpg"/>
<div class="navbar">
<span class="sitename"><a href="../index.html" title="">Sébastien Brisard's blog</a></span>
<ul>
<li><a href="../index.html" title="Home"><span class="fa fa-home"></span></a></li>
<li><a href="https://cv.archives-ouvertes.fr/sbrisard" title="About me"><span class="fa fa-user"></span></a></li>
<li><a href="../pages/references.html" title="References"><span class="fa fa-book"></span></a></li>
<li><a href="archives.html" title="Archives"><span class="fa fa-archive"></span></a></li>
<li><a href="https://github.com/sbrisard" title="GitHub"><span class="fa fa-github"></span></a></li>
<li><a href="https://bitbucket.org/sbrisard" title="Bitbucket"><span class="fa fa-bitbucket"></span></a></li>
<li><a href="https://twitter.com/SebBrisard" title="Twitter"><span class="fa fa-twitter"></span></a></li>
<li><a href="../feed.xml" title="RSS"><span class="fa fa-rss"></span></a></li>
</ul>
</div>
<div id="titleblock">
<p class="date">2013-09-17</p>
<h1 class="title">LaTeX: a bug with subequations</h1>
</div>
</div>
<div id="content">
<h1 class="title">LaTeX: a bug with subequations</h1>
<p>
While working on my latest paper, I've come accross what looks like a bug with the <code>subequations</code> environment from the <a href="http://www.ams.org/publications/authors/tex/amslatex">amsmath</a> package. Here is a simple code snippet that demonstrates this bug
</p>

<div class="org-src-container">
<pre class="src src-latex"><span class="org-font-latex-sedate"><span class="org-keyword">\documentclass</span></span>{<span class="org-function-name">article</span>}
<span class="org-font-latex-sedate"><span class="org-keyword">\usepackage</span></span>{<span class="org-function-name">amsmath</span>}

<span class="org-font-latex-sedate"><span class="org-keyword">\begin</span></span>{<span class="org-function-name">document</span>}
<span class="org-font-latex-sedate"><span class="org-keyword">\begin</span></span>{<span class="org-function-name">equation</span>}
<span class="org-font-latex-math">  a</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math">-b</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math"> = (a-b)(a+b)</span>
<span class="org-font-latex-sedate"><span class="org-keyword">\end</span></span>{<span class="org-function-name">equation</span>}

<span class="org-font-latex-sedate"><span class="org-keyword">\begin</span></span>{<span class="org-function-name">subequations</span>}
  <span class="org-font-latex-sedate"><span class="org-keyword">\begin</span></span>{<span class="org-function-name">align</span>}
<span class="org-font-latex-math">    (a + b)</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math"> </span><span class="org-font-latex-math"><span class="org-font-latex-warning">&amp;</span></span><span class="org-font-latex-math">= a</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math"> + 2ab + b</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math"><span class="org-font-latex-warning">\\</span></span>
<span class="org-font-latex-math">    (a - b)</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math"> </span><span class="org-font-latex-math"><span class="org-font-latex-warning">&amp;</span></span><span class="org-font-latex-math">= a</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math"> - 2ab + b</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span>
<span class="org-font-latex-math">  </span><span class="org-font-latex-sedate"><span class="org-keyword">\end</span></span>{<span class="org-function-name">align</span>}
<span class="org-font-latex-sedate"><span class="org-keyword">\end</span></span>{<span class="org-function-name">subequations</span>}

<span class="org-font-latex-sedate"><span class="org-keyword">\begin</span></span>{<span class="org-function-name">equation</span>}
<span class="org-font-latex-math">  a</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^3</span></span><span class="org-font-latex-math"> - b</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^3</span></span><span class="org-font-latex-math"> = (a - b)(a</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math"> + ab + b</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math">)</span>
<span class="org-font-latex-sedate"><span class="org-keyword">\end</span></span>{<span class="org-function-name">equation</span>}
<span class="org-font-latex-sedate"><span class="org-keyword">\end</span></span>{<span class="org-function-name">document</span>}
</pre>
</div>

<p>
As it should, the code above results in the following document
</p>


<div class="figure">
<p><img src="./20130917-LaTeX_a_bug_with_subequations/subequations_ok.png" alt="subequations_ok.png" width="400px" height="170px">
</p>
</div>

<p>
Now, assume that Eqs. (2a) and (2b) are never referred to; then the equation numbers might be removed. A natural way to do so would be starring the <code>align</code> environment
</p>

<div class="org-src-container">
<pre class="src src-latex"><span class="org-font-latex-sedate"><span class="org-keyword">\documentclass</span></span>{<span class="org-function-name">article</span>}
<span class="org-font-latex-sedate"><span class="org-keyword">\usepackage</span></span>{<span class="org-function-name">amsmath</span>}

<span class="org-font-latex-sedate"><span class="org-keyword">\begin</span></span>{<span class="org-function-name">document</span>}
<span class="org-font-latex-sedate"><span class="org-keyword">\begin</span></span>{<span class="org-function-name">equation</span>}
<span class="org-font-latex-math">  a</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math">-b</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math"> = (a-b)(a+b)</span>
<span class="org-font-latex-sedate"><span class="org-keyword">\end</span></span>{<span class="org-function-name">equation</span>}

<span class="org-font-latex-sedate"><span class="org-keyword">\begin</span></span>{<span class="org-function-name">subequations</span>}
  <span class="org-font-latex-sedate"><span class="org-keyword">\begin</span></span>{<span class="org-function-name">align*</span>}
<span class="org-font-latex-math">    (a + b)</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math"> </span><span class="org-font-latex-math"><span class="org-font-latex-warning">&amp;</span></span><span class="org-font-latex-math">= a</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math"> + 2ab + b</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math"><span class="org-font-latex-warning">\\</span></span>
<span class="org-font-latex-math">    (a - b)</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math"> </span><span class="org-font-latex-math"><span class="org-font-latex-warning">&amp;</span></span><span class="org-font-latex-math">= a</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math"> - 2ab + b</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span>
<span class="org-font-latex-math">  </span><span class="org-font-latex-sedate"><span class="org-keyword">\end</span></span>{<span class="org-function-name">align*</span>}
<span class="org-font-latex-sedate"><span class="org-keyword">\end</span></span>{<span class="org-function-name">subequations</span>}

<span class="org-font-latex-sedate"><span class="org-keyword">\begin</span></span>{<span class="org-function-name">equation</span>}
<span class="org-font-latex-math">  a</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^3</span></span><span class="org-font-latex-math"> - b</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^3</span></span><span class="org-font-latex-math"> = (a - b)(a</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math"> + ab + b</span><span class="org-font-latex-math"><span class="org-font-latex-script-char">^2</span></span><span class="org-font-latex-math">)</span>
<span class="org-font-latex-sedate"><span class="org-keyword">\end</span></span>{<span class="org-function-name">equation</span>}
<span class="org-font-latex-sedate"><span class="org-keyword">\end</span></span>{<span class="org-function-name">document</span>}
</pre>
</div>

<p>
Here is the result
</p>


<div class="figure">
<p><img src="./20130917-LaTeX_a_bug_with_subequations/subequations_bug.png" alt="subequations_bug.png" width="400px" height="170px">
</p>
</div>

<p>
The two equations in the <code>subequations</code> environment are no longer numbered. However, the equation number is wrongly incremented! Therefore, not only should the <code>align</code> environment be starred, but the <code>subequations</code> should also be commented out.
</p>
</div>
<div id="postamble" class="status">
<p><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Except where otherwise noted, this blog</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://sbrisard.github.io/" property="cc:attributionName" rel="cc:attributionURL">Sébastien Brisard</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.
This blog was generated with <a href="http://www.gnu.org/software/emacs/">Emacs</a> and <a href="http://orgmode.org/">Org mode</a>. The theme is inspired from <a href="http://orgmode.org/worg/">Worg</a>. Icons come from the <a href="http://fontawesome.io/">Font Awesome</a> icon set.</p><div id="disqus_thread"></div>
<script type="text/javascript">
var disqus_shortname = 'sbrisard';
var disqus_identifier = 'posts/20130917-LaTeX_a_bug_with_subequations';
var disqus_title = 'LaTeX: a bug with subequations';
var disqus_url = 'http://sbrisard.github.io/posts/20130917-LaTeX_a_bug_with_subequations.html';
(function() {
var dsq = document.createElement('script');
dsq.type = 'text/javascript';
dsq.async = true;
dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
</body>
</html>
