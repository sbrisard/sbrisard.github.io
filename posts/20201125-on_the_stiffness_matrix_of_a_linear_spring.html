<!DOCTYPE html>
<html lang="en">
  <head>
      <title>Sébastien Brisard's blog - On the stiffness matrix of a linear spring</title>
    <link rel="stylesheet" href="https://sbrisard.github.io/theme/css/main.css" />
    <meta charset="utf-8" />
    <link rel="stylesheet" href="https://sbrisard.github.io/theme/katex/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous"/>
    <script defer src="https://sbrisard.github.io/theme/katex/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://sbrisard.github.io/theme/katex/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body, {macros: {'\\D': '\\mathrm{d}', '\\dbldot': '\\mathbin{\\mathord{:}}', '\\tens': '\\bm', '\\tr': '\\operatorname{tr}', '\\vec': '\\bm'}, delimiters: [{left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}]});"></script>
    <link href="https://sbrisard.github.io/feed.xml" type="application/rss+xml" rel="alternate" title="Sébastien Brisard's blog Full RSS Feed" />





  </head>

  <body id="index" class="home">
    <header id="siteheader">
      <img id="sitebanner" src="https://sbrisard.github.io/theme/images/banner.jpg"/>
      <div id="sitename"><a href="https://sbrisard.github.io/">Sébastien Brisard's blog <strong></strong></a></div>
      <nav id="sitemenu">
	<ul>
          <li><a href="/pages/about.html" title="About this blog">About this blog</a></li>
          <li><a href="https://cv.archives-ouvertes.fr/sbrisard" title="About me">About me</a></li>
          <li><a href="/archives.html" title="Archives">Archives</a></li>
          <li><a href="https://github.com/sbrisard" title="GitHub">GitHub</a></li>
          <li><a href="https://twitter.com/SebBrisard" title="Twitter">Twitter</a></li>
          <li><a href="feed.xml" title="RSS">RSS</a></li>
	</ul>
      </nav>
    </header>
<section id="content" class="body">
  <header>
    <h1 class="entry-title">
      <a href="https://sbrisard.github.io/posts/20201125-on_the_stiffness_matrix_of_a_linear_spring.html" rel="bookmark"
         title="Permalink to On the stiffness matrix of a linear spring">On the stiffness matrix of a linear spring</a></h1>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2020-11-25T00:00:00+01:00">
      Published 25 November 2020
    </time>
    <address class="vcard author">
      by           <a class="url fn" href="https://sbrisard.github.io/author/sebastien-brisard.html">Sébastien Brisard</a>
    </address>
    <div class="category">
        Category: <a href="https://sbrisard.github.io/category/posts.html">posts</a>
    </div>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>This post is not going to be the most exciting I have ever written. We will
derive the expression of the elastic energy of a linear spring as a function of
the displacement of its two end-points. I will need this expression in my series
on <a href="{filename}">“What is homogenization”</a>. Having derived the elastic energy, we
will be only one step away from the stiffness matrix of the spring, to be used
in a finite element setting.</p>
<h2>Expression of the elastic energy</h2>
<p><img alt="A linear spring" class="fig50p100" src="https://sbrisard.github.io/posts/On_the_stiffness_matrix_of_a_linear_spring/spring.png"></p>
<p>We consider a spring located between points $A$ and $B$. Its initial length (at
rest) is $L$, and we introduce the unit vector $\vec n$ that points from $A$ to
$B$</p>
<p>$$\vec X_B=\vec X_A+L\,\vec n,$$</p>
<p>where $\vec X_A$ and $\vec X_B$ denote the radius vectors of points $A$ and $B$
in the initial (undeformed) configuration.</p>
<p>At equilibrium, the length of the spring is $\ell$ and its elastic energy is
$$U=\tfrac12k\bigl(\ell-L\bigr)^2,$$
where $k$ denotes the stiffness of the spring. We want to express this elastic
energy as a function of the displacements $\vec u_A$ and $\vec u_B$ of the
points $A$ and $B$</p>
<p>$$\vec x_A=\vec X_A+\vec u_A\quad\text{and}\quad\vec x_B=\vec X_B+\vec u_B,$$</p>
<p>where $\vec x_A$ and $\vec x_B$ now denote the radius vectors of points $A$
and $B$ in the current (deformed) configuration. We will work under the
assumption that these displacements are small and we will keep only the lowest
order term of the energy.</p>
<p>We have</p>
<p>$$\ell=\lVert\vec x_B-\vec x_A\rVert=\lVert\vec X_B-\vec X_A+\vec u_B-\vec u_A\rVert=L\lVert\vec n+\vec\xi\rVert,$$</p>
<p>where we have introduced the following dimensionless vector</p>
<p>$$\vec\xi=L^{-1}\bigl(\vec u_B-\vec u_A\bigr).$$</p>
<p>Then</p>
<p>$$\ell^2=L^2\bigl(\vec n+\vec\xi\bigr)^2=L^2\bigl(1+2\,\vec n\cdot\vec\xi+\vec\xi\cdot\vec\xi\bigr)$$</p>
<p>and, to first order in $\vec\xi$</p>
<p>$$\ell=L\bigl[1+\vec n\cdot\vec\xi+\mathcal O(\vec\xi^2)\bigr].$$</p>
<p>Plugging the expression of $\vec\xi$ as a function of the displacements $\vec
u_A$ and $\vec u_B$, we find the elongation of the spring</p>
<p>$$\ell-L=\vec n\cdot\bigl(\vec u_B-\vec u_A\bigr)+\text{h.o.t.}$$</p>
<p>Finally, the elastic energy of the spring is, to lowest order</p>
<p>$$U=\tfrac12k\bigl[\vec n\cdot\bigl(\vec u_B-\vec u_A\bigr)\bigr]^2,$$</p>
<p>which is the expression we were looking for.</p>
<h2>Expression of the stiffness matrix</h2>
<p>The above expression can also be written</p>
<p>$$U=\tfrac12k\bigl(\vec u_B-\vec u_A\bigr)\cdot\bigl(\vec n\otimes\vec n\bigr)\cdot\bigl(\vec u_B-\vec u_A\bigr)$$</p>
<p>and, upon expansion</p>
<p>$$U=\tfrac12k\bigl[\vec u_A\cdot\bigl(\vec n\otimes\vec n\bigr)\cdot\vec u_A+\vec u_B\cdot\bigl(\vec n\otimes\vec n\bigr)\cdot\vec u_B-2\vec u_A\cdot\bigl(\vec n\otimes\vec n\bigr)\cdot\vec u_B\bigr].$$</p>
<p>This delivers the expression of the stiffness matrix of the spring. Indeed, let
$q$ be the vector of dofs of the spring. This is a column vector of size $2d$
($d$: number of spatial dimensions): $q=[\vec u_A, \vec u_B]^\mathsf{T}$,
where we store first the $d$ components of the displacement of point $A$, then
the $d$ components of the displacement of point $B$. The elastic energy of the
spring can now be written</p>
<p>$$U=\tfrac12q^\mathsf{T}\cdot K\cdot q,$$</p>
<p>where the stiffness matrix $K$ reads, in block form</p>
<p>$$K=k\begin{bmatrix}\vec n\otimes\vec n &amp; -\vec n\otimes\vec n\\-\vec n\otimes\vec n &amp; \vec n\otimes\vec n\end{bmatrix}.$$</p>
<p>For $d=2$, we introduce the components $u_\star$ and $v_\star$ of the
displacement $\vec u_\star$</p>
<p>$$\vec u_\star=u_\star\,\vec e_x+v_\star\,\vec e_y,\quad q^\mathsf{T}=\bigl[u_A, v_A, u_B, v_B\bigr]$$</p>
<p>and</p>
<p>$$K=k\begin{bmatrix}
n_xn_x &amp; n_xn_y &amp; -n_xn_x &amp; -n_xn_y\\
n_xn_y &amp; n_yn_y &amp; -n_xn_y &amp; -n_yn_y\\
-n_xn_x &amp; -n_xn_y &amp; n_xn_x &amp; n_xn_y\\
-n_xn_y &amp; -n_yn_y &amp; n_xn_y &amp; n_yn_y
\end{bmatrix}.$$</p>
<p>For $d=3$, we introduce the components $u_\star$, $v_\star$ and $w_\star$ of
the displacement $\vec u_\star$</p>
<p>$$\vec u_\star=u_\star\,\vec e_x+v_\star\,\vec e_y+w_\star\,\vec e_z,\quad q^\mathsf{T}=\bigl[u_A, v_A, w_A, u_B, v_B, w_B\bigr]$$</p>
<p>and</p>
<p>$$K=k\begin{bmatrix}
 n_xn_x &amp;  n_xn_y &amp;  n_xn_z &amp; -n_xn_x &amp; -n_xn_y &amp; -n_xn_z\\
 n_yn_x &amp;  n_yn_y &amp;  n_yn_z &amp; -n_yn_x &amp; -n_yn_y &amp; -n_yn_z\\
 n_zn_x &amp;  n_zn_y &amp;  n_zn_z &amp; -n_zn_x &amp; -n_zn_y &amp; -n_zn_z\\
-n_xn_x &amp; -n_xn_y &amp; -n_xn_z &amp;  n_xn_x &amp;  n_xn_y &amp;  n_xn_z\\
-n_yn_x &amp; -n_yn_y &amp; -n_yn_z &amp;  n_yn_x &amp;  n_yn_y &amp;  n_yn_z\\
-n_zn_x &amp; -n_zn_y &amp; -n_zn_z &amp;  n_zn_x &amp;  n_zn_y &amp;  n_zn_z
\end{bmatrix}.$$</p>
<!-- Local Variables: -->

<!-- fill-column: 80 -->

<!-- coding: utf-8 -->

<!-- End: -->
  </div><!-- /.entry-content -->
</section>
<section>
  <h2>Comments</h2>
  <p>Please send your comments to <strong><code>sebastien [dot]
  brisard [at] ifsttar [dot] fr</code></strong>. Your comments will be
  inserted below. Your email address will <em>not</em> appear.</p>
</section>
    <footer id="contentinfo" class="body">
      <p><a rel="license" href="http://creativecommons.org/licenses/by/4.0/" ><img alt="Creative Commons License" style="float:left;margin-right:5px;" src="https://i.creativecommons.org/l/by/4.0/88x31.png"/></a>Except where otherwise noted, content on this blog by <a href="https://cv.archives-ouvertes.fr/sbrisard">Sébastien Brisard</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>&nbsp;&mdash;&nbsp;This blog is proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>&nbsp;&mdash;&nbsp;This blog uses <a href="https://www.nordtheme.com/">Nord</a>, an arctic north-bluish color palette.</p>
    </footer>
  </body>
</html>